/* Select */
/* Basic selection with limit */
SELECT * FROM zips LIMIT 3;
   city    |  pop  | state 
-----------+-------+-------
 BARRE     |  4546 | MA
 AGAWAM    | 15338 | MA
 BLANDFORD |  1240 | MA
(3 rows)

/* Select less fields than exist */
SELECT city FROM zips LIMIT 1;
 city  
-------
 BARRE
(1 row)

/* Basic WHERE clause */
SELECT * FROM zips WHERE "state" = 'CO' LIMIT 2;
  city  |  pop  | state 
--------+-------+-------
 ARVADA | 12065 | CO
 ARVADA | 32980 | CO
(2 rows)

/* Nested selection */
SELECT * FROM nested LIMIT 1;
 a | b | c 
---+---+---
 m | n | o
(1 row)

/* less fields than in relation, with one in a WHERE clause */
SELECT city FROM zips WHERE "state" = 'CO' LIMIT 1;
  city  
--------
 ARVADA
(1 row)

SELECT city,pop FROM zips WHERE pop % 2 = 1 LIMIT 3;
     city     |  pop  
--------------+-------
 BELCHERTOWN  | 10579
 CUSHMAN      | 36963
 CHESTERFIELD |   177
(3 rows)

/* Test out array usage */
SELECT * FROM zipsloc LIMIT 2;
ERROR:  Array types not supported by quasar_fdw. Use json
/* Test out json usage */
SELECT loc->0 AS loc0, locb->1 AS loc1, locb FROM zipsjson LIMIT 2;
    loc0    |   loc1    |          locb           
------------+-----------+-------------------------
 -72.108354 | 42.409698 | [-72.108354, 42.409698]
 -72.622739 | 42.070206 | [-72.622739, 42.070206]
(2 rows)

/* Pushdown regex operators */
SELECT * FROM zips WHERE "state" LIKE 'A%' LIMIT 3;
    city    |  pop  | state 
------------+-------+-------
 ADAMSVILLE | 10616 | AL
 ACMAR      |  6055 | AL
 ADGER      |  3205 | AL
(3 rows)

SELECT * FROM zips WHERE "city" !~~ 'B%' LIMIT 3;
  city   |  pop  | state 
---------+-------+-------
 AGAWAM  | 15338 | MA
 CUSHMAN | 36963 | MA
 CHESTER |  1688 | MA
(3 rows)

/* pushdown math operators */
SELECT * FROM zips WHERE pop > 1000 AND pop + pop <= 10000 LIMIT 3;
   city    | pop  | state 
-----------+------+-------
 BARRE     | 4546 | MA
 BLANDFORD | 1240 | MA
 BRIMFIELD | 3706 | MA
(3 rows)

/* join zips and zipsjson */
SELECT zips.city AS city, pop, state, loc
       FROM zips JOIN zipsjson ON zips.city = zipsjson.city
       LIMIT 3;
  city  |  pop  | state |          loc           
--------+-------+-------+------------------------
 BARRE  |  4546 | MA    | [-72.108354,42.409698]
 BARRE  |  4546 | MA    | [-72.493619,44.194522]
 AGAWAM | 15338 | MA    | [-72.622739,42.070206]
(3 rows)

